<!DOCTYPE html>
<html lang="ru" ng-app="menuApp" class="dark">
<head>
  <meta charset="UTF-8">
  <title>Меню</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body ng-controller="MenuController" class="bg-gray-900 text-white p-6 font-sans">

  <h1 class="text-2xl mb-4">Меню</h1>

  <div ng-repeat="dish in dishes" class="bg-gray-800 p-4 rounded-lg mb-2">
    <div class="flex items-center space-x-4">
      <img ng-if="dish.image" ng-src="{{dish.image}}" alt="Фото" class="w-16 h-16 object-cover rounded" />
      <div class="flex-1">
        <p class="text-lg font-semibold">{{dish.name}}</p>
        <p class="text-gray-400">{{dish.price}}</p>
      </div>
      <button ng-click="addToCart(dish)"
        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">+</button>
    </div>
  </div>

  <script>
    angular.module("menuApp", []).controller("MenuController", function ($scope) {
      const tg = window.Telegram.WebApp;
      const mainBtn = tg.MainButton;

      $scope.dishes = JSON.parse(localStorage.getItem('dishes') || '[]');
      $scope.cart = [];

      mainBtn.setText("Заказать");
      mainBtn.onClick(() => {
        tg.sendData(JSON.stringify($scope.cart));
      });

      $scope.addToCart = function (dish) {
        $scope.cart.push(dish);
        if ($scope.cart.length > 0) mainBtn.show();
      };
    });
  </script>
</body>
</html>
